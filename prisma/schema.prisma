// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  id       Int    @id @default(autoincrement())
  name     String
  email    String @unique
  phone    Int?
  password String

  Roles     Roles?  @relation(fields: [roleId], references: [id])
  roleId    Int?
  Profile   Profile @relation(fields: [profileId], references: [id])
  profileId Int     @unique

  carts     Carts[]
  cartItems CartItems[]
  invoice   Invoices[]

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt
}

model Roles {
  id   Int     @id @default(autoincrement())
  name String
  user Users[]
}

model Profile {
  id        Int    @id @default(autoincrement())
  locations String
  Users     Users?

  location Locations[]
}

model Carts {
  id       Int @id @default(autoincrement())
  price    Int
  discount Int

  Users   Users?  @relation(fields: [userId], references: [id])
  userId  Int?
  Stores  Stores? @relation(fields: [storeId], references: [id])
  storeId Int?

  cartItems CartItems[]
  invoices  Invoices[]
}

model CartItems {
  id    Int @id @default(autoincrement())
  qty   Int
  price Int

  Carts                Carts?               @relation(fields: [cartId], references: [id])
  cartId               Int?
  Users                Users?               @relation(fields: [userId], references: [id])
  userId               Int?
  Stores               Stores?              @relation(fields: [storeId], references: [id])
  storeId              Int?
  VariantOptionValues  VariantOptionValues? @relation(fields: [variantOptionValueId], references: [id])
  variantOptionValueId Int?
}

model Invoices {
  id                 Int    @id @default(autoincrement())
  price              Int
  serviceCharge      Int
  status             String
  receiverLatitude   Float
  receiverLongtitude Float
  receiverDistrict   String
  receiverPhone      Int
  receiverAddress    String
  receiverName       String
  receiverNumber     Int

  Carts  Carts? @relation(fields: [cartId], references: [id])
  cartId Int?
  Users  Users? @relation(fields: [userId], references: [id])
  userId Int?

  confirmationPayment ConfirmationPayment?
  courier             Couriers?
  Payments            Payments?
  invoiceHistory      InvoiceHistories[]
}

model ConfirmationPayment {
  id     Int    @id @default(autoincrement())
  amount Int
  bank   String

  Invoices  Invoices? @relation(fields: [invoiceId], references: [id])
  invoiceId Int       @unique
}

model InvoiceHistories {
  id        Int      @id @default(autoincrement())
  status    String
  createdAt DateTime @default(now())

  Invoices  Invoices? @relation(fields: [invoiceId], references: [id])
  invoiceId Int?
}

model Payments {
  id                 Int    @id @default(autoincrement())
  bank               String
  amount             Int
  status             String
  mootaTransactionId Int

  invoice   Invoices @relation(fields: [invoiceId], references: [id])
  invoiceId Int      @unique
}

model Couriers {
  id                 Int    @id @default(autoincrement())
  courierCode        String
  courierServiceName String
  courierServiceCode String
  price              Int
  orderId            Int

  Invoices  Invoices? @relation(fields: [invoiceId], references: [id])
  invoiceId Int       @unique
}

model Stores {
  id               Int    @id @default(autoincrement())
  name             String
  slogan           String
  description      String
  domain           String
  logoAttachment   String
  bannerAttachment String

  carts              Carts[]
  cartItems          CartItems[]
  products           Products[]
  bankAccounts       BankAccounts[]
  storeOnDecorations StoreOnDecorations[]
  operationHours     OperationHours[]
  messageTemplate    MessageTemplate[]
  location           Locations[]
}

model StoreOnDecorations {
  id Int @id @default(autoincrement())

  Decorations  Decorations? @relation(fields: [decorationId], references: [id])
  decorationId Int?
  Stores       Stores?      @relation(fields: [storeId], references: [id])
  storeId      Int?
}

model Decorations {
  id                 Int                  @id @default(autoincrement())
  storeOnDecorations StoreOnDecorations[]
}

model OperationHours {
  id      Int     @id @default(autoincrement())
  day     String
  openAt  Int
  closeAt Int
  isOff   Boolean

  Stores  Stores? @relation(fields: [storeId], references: [id])
  storeId Int?
}

model MessageTemplate {
  id      Int    @id @default(autoincrement())
  name    String
  content String

  Stores  Stores? @relation(fields: [storeId], references: [id])
  storeId Int?
}

model Locations {
  id             Int     @id @default(autoincrement())
  name           String
  address        String
  postalCode     Int
  cityDistrict   String
  latitude       Float
  longtitude     Float
  isMainLocation Boolean

  Stores  Stores? @relation(fields: [storeId], references: [id])
  storeId Int?

  Profile   Profile? @relation(fields: [profileId], references: [id])
  profileId Int?
}

model BankAccounts {
  id        Int    @id @default(autoincrement())
  bank      String
  accNumber Int
  accName   String

  Stores  Stores? @relation(fields: [storeId], references: [id])
  storeId Int?
}

model Products {
  id           Int     @id @default(autoincrement())
  name         String
  description  String?
  attachments  String
  isActive     Boolean
  size         String
  minimumOrder Int

  Stores  Stores? @relation(fields: [storeId], references: [id])
  storeId Int?

  variants   Variants[]
  catogories Categories[]
}

model Categories {
  id   Int    @id @default(autoincrement())
  name String

  products  Products? @relation(fields: [productId], references: [id])
  productId Int?
}

model Variants {
  id       Int     @id @default(autoincrement())
  name     String
  isActive Boolean

  products  Products? @relation(fields: [productId], references: [id])
  productId Int?

  variantOptions VariantOptions[]
}

model VariantOptions {
  id   Int    @id @default(autoincrement())
  name String

  variant   Variants @relation(fields: [variantId], references: [id])
  variantId Int

  values VariantOptionValues[]
}

model VariantOptionValues {
  id       Int     @id @default(autoincrement())
  sku      String
  weight   Float
  stock    Int
  price    Float
  isActive Boolean

  variantOptions  VariantOptions @relation(fields: [variantOptionId], references: [id])
  variantOptionId Int

  cartItems CartItems[]
}
